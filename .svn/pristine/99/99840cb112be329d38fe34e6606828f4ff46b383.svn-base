package com.xuyurepos.common.analysis;

import java.util.Iterator;
import java.util.LinkedHashMap;
import java.util.Map;
import java.util.Map.Entry;

import org.apache.commons.beanutils.BeanUtils;
/**
 * Excel解析参考示例
 * @author yangfei
 *
 */
public class LargeExcelFileReadUtil extends LargeExcelFileRead{
	
	public static void main(String[] args) throws Exception {
		Long time=System.currentTimeMillis();
		String filename="C:\\Users\\yangfei\\Desktop\\旭宇科技\\EcssDeviceAEXP_ec_0961347_20190319083851_4240550	··请问4.xlsx";
		LargeExcelFileReadUtil excelFileReadUtil=new LargeExcelFileReadUtil();
		excelFileReadUtil.processAllSheets(filename);
		Long endtime=System.currentTimeMillis();
		System.out.println("耗时"+(endtime-time)/1000+"秒");
	}

	@Override
	protected void dealData(LinkedHashMap<String, String> map, int i) {
		try {
			Iterator<Entry<String, String>> it= map.entrySet().iterator();
			int count=0;
		    String prePos="";
		    TestVo orgVo=new TestVo();
			while (it.hasNext()){
	            Map.Entry<String, String> entry=(Map.Entry<String, String>)it.next();
	            String pos=entry.getKey();
	            if(!pos.substring(1).equals(prePos)){
	                prePos=pos.substring(1);
	                count++;
	                if(count!=1){
	                	 System.out.println(i+"解析数据"+orgVo.toString());
	                	 orgVo=new TestVo();
	                }
	            }
	            BeanUtils.setProperty(orgVo,pos.substring(0,1).toLowerCase(),entry.getValue());
	        }
			System.out.println(i+"解析数据"+orgVo.toString());
			System.out.println(i+"解析数据"+count+"条");
			
		} catch (Exception e) {
			e.printStackTrace();
		}
		
	}

}
