package com.xuyurepos.service.intergration.xuyu.facade;

import java.util.HashMap;
import java.util.Map;
import java.util.TreeMap;

import com.xuyurepos.common.util.httpclient.HttpTookit;
import com.xuyurepos.service.intergration.xuyu.telecom.sign.TelecomSign;
import com.xuyurepos.service.intergration.xuyu.telecom.util.TelecomDesEncrypt;

public class TelecomCMPRequest {

	public static final String request_url="http://api.ct10649.com:9001/m2m_ec/query.do";
	
	public static Map init() {
		Map initMap=new HashMap();
    	//具体接口参数需参照自管理门户在线文档
    	String user_id = "shizhang";     //用户名
    	String password = "shizhang123A";    //密码
        String key="633c4846B";
        
        initMap.put("userId",user_id);
        initMap.put("password", password);
        initMap.put("key", key);
        return initMap;
	}

	
	/**
	 * 
	 * @param access_number 物联网卡号(149或10649号段)
	 * @param method 接口名
	 * @param pageIndex 当前页
	 * @return
	 */
	public static String telecomCMPRequest(String access_number,String method,String pageIndex) {
		
		Map<String,String> initMap=init();
		
		String user_id=initMap.get("userId");		
		String password=initMap.get("password");
		String key=initMap.get("key");
    	String[] arr = {access_number,user_id,password,method,pageIndex}; //加密数组，数组所需参数根据对应的接口文档
		
//    	
		String passwordEnc = TelecomDesEncrypt.strEnc(password,key);  //密码加密 
//		System.out.println("密码加密结果:"+passwordEnc);
//    	
//		String passwordDec = TelecomDesEncrypt.strDec(passwordEnc,key);//密码解密
//		System.out.println("密码解密结果:"+passwordDec);
//		//密码解密结果 :test
//
//		
		String sign = TelecomSign.sign(arr); //生成sign加密值
//		System.out.println("sign加密结果:"+sign);
//		//sign加密结果：45E8B9924DE397A8F7E5764767810CF774CC7E1685BA702C9C4C367EFDAE5D932B37C0C8F0F8EB0CAD6372289F407CA941894168BD86A2CC32E5804EA05BAA5099649468B9418E52
//		
//		
//		String signDec = TelecomDesEncrypt.strDec(sign,key); //sign解密
//		System.out.println("sign解密结果:"+signDec);
//		//sign解密结果：14914000000,queryPakage,test,test		
   Map params=new HashMap();
   params.put("method",method);
   params.put("user_id", user_id);
   params.put("access_number",access_number);
   params.put("pageIndex",pageIndex);
   params.put("passWord",passwordEnc);
   params.put("sign", sign);

	String result=HttpTookit.doGet(request_url, params,"UTF-8");
	System.out.println(result);
	
	return result;
	
	
	}
	
	
	public static void main(String[] args) {

		telecomCMPRequest("1064925961223", "forwardFlowPoolMember", "1");

    	

	
	}
}
