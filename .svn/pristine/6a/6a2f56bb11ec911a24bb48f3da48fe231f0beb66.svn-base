package com.xuyurepos.serviceImpl.system;

import java.util.ArrayList;
import java.util.List;

import javax.annotation.Resource;

import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import com.xuyurepos.common.page.PageModel;
import com.xuyurepos.common.util.ComboBoxUtils;
import com.xuyurepos.common.util.StringUtil;
import com.xuyurepos.dao.system.SystemLookUpItemDao;
import com.xuyurepos.entity.system.SystemLookUpItem;
import com.xuyurepos.service.system.SystemLookUpItemService;
/**
 * 系统数据字典实现方法
 * @author yangfei
 */
@Service
@Transactional
public class SystemLookUpItemServiceImpl implements SystemLookUpItemService{

	@Resource
	private SystemLookUpItemDao lookUpItemDao;
	
	@SuppressWarnings({ "unchecked", "rawtypes" })
	@Override
	public void findList(PageModel pageModel) {
		pageModel.setRows(lookUpItemDao.selectUserListWithPage(pageModel));
	    pageModel.setTotal(lookUpItemDao.selectUserCountWithPage(pageModel));
	}

	@Override
	public void delete(String ids) {
		if(!StringUtil.isEmpty(ids)){
			String[] idsStr=ids.split(";");
			for (int i = 0; i < idsStr.length; i++) {
				if(!StringUtil.isEmpty(idsStr[i])){
					Integer id=Integer.valueOf(idsStr[i]);
					SystemLookUpItem systemLookUpItem=lookUpItemDao.find(id);
					if(systemLookUpItem!=null){
						lookUpItemDao.del(id);
					}
				}
			}
		}
	}

	@Override
	public List<ComboBoxUtils> findList(String fLookUpId) {
		List<ComboBoxUtils> list = new ArrayList<ComboBoxUtils>();
		List<SystemLookUpItem> result=lookUpItemDao.getList(fLookUpId);
		try {
			if (result != null && result.size() > 0) {
				boolean selected = false;
				for (int i = 0; i < result.size(); i++) {
					SystemLookUpItem obj = result.get(i);
					String value = obj.getfCode();
					String text = obj.getfValue();
					if (i == 0) {
						selected = true;
					} else {
						selected = false;
					}
					ComboBoxUtils item = new ComboBoxUtils(i + "", value, text, selected);
					list.add(item);
				}
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
		return list;
	}

}
